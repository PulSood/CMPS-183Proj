{{extend 'layout.html'}}
{{block head}}

<script src="{{=URL('static', 'js/vue.js')}}"></script>
<script>
   var make_profile_URL = "{{=URL('api', 'make_profile', user_signature=True)}}";
   var add_sitter_URL = "{{=URL('api', 'add_sitter', user_signature=True)}}";
   var add_owner_URL = "{{=URL('api', 'add_owner', user_signature=True)}}";
   var get_profiles_list_url = "{{=URL('api', 'get_profiles_list')}}";
   var add_pet_url = "{{=URL('api', 'add_pet', user_signature=True)}}";
   var view_profile_url ="{{URL('api', 'view_profile')}}";
   var get_image_url = "{{=URL('api', 'get_image', user_signature=True, hash_vars=False)}}";
   var get_petlist_url = "{{=URL('api', 'get_petlist', user_signature=True, hash_vars=False)}}";
   var delete_pet_url = "{{=URL('api', 'delete_pet', user_signature=True, hash_vars=False)}}";
   var logged_in_userID = "{{=None if auth.user is None else auth.user.id}}"

   </script>
{{end}}

{{if auth.user is None:}}
<div id="splash_background" style="width:100vw;height:100vh">
    <div id="splash_title">
        <div>PETMET</div>
    </div>
    <div id="content" class="jumbotron">
        <span class="half">
            <p>Welcome to PetMet!</p>
            <p>Please login to create your personalized experience.</p>
        </span>
        <span class="half">
            <a class="btn padded" style="width:200px" href="{{=URL('default', 'user/login')}}">Log In</a>
            <a class="btn padded" style="width:200px" href="{{=URL('default', 'user/register')}}">Sign Up</a>
        </span>
    </div>
</div>

{{else:}}
<div id="main">
<div id="splash_background" style="width:100vw;height:100vh">
  <div v-if="state === 'home'">
    <div id="pawPage" class="jumbotron">
      
      
        <h2>Navigation Paw</h2>
          
      <button class="buttonPaw" v-on:click="change_state('profile'); view_profile(logged_in_userID)">Profile</button>   
      <button class="buttonPaw" v-on:click="change_state('listings');initSearch('sitter')">Sitters</button>
      <button class="buttonPaw" v-on:click="change_state('listings');initSearch('owner')">Owners</button>
      <button class="buttonPaw buttonPalm" v-on:click="change_state('contacts')">Contacts</button>
      
      <a class="btn padded" style="width:200px" href="{{=URL('default', 'user/logout')}}">Log Out</a>
    </div>

    <!-- ............End Home Page .............................-->

    <!-- ............View Profile ................................-->
    <div v-if="state === 'profile'">
      <!-- Add code here so that if user has no profile we change the state to
      go to editProfile -->
      <div v-for="person in a_profile">
        <img v-bind:src="person.image" width="45%" height="45%">
        <div class="panel-default">Name: ${person.first_name} ${person.last_name}</div>
        <div class="panel-default">Contact Info: ${person.contact_info}</div>
        <div class="panel-default">City: ${person.city}</div>
        <div v-if="isSitter">
          <div v-for="sitter in a_sitter">
            <div class="panel-default">Sitter: ${sitter.description}</div>
          </div>
        </div>
        <div v-if="isOwner">
          <div v-for="owner in a_owner">
            <div class="panel-default">Owner: ${owner.description}</div>
          </div>
        </div>
      </div>
      <div id="backButton">
        <button v-on:click="change_state('home')">Back</button>
        <button v-on:click="change_state('editProfile')">Edit Profile</button>
      </div>
    </div>

    <!-- ............. Begin Profile Settings Form .......... -->
    <!-- Shawn working on this code, update when he is done -->
  </div>
</div>


{{pass}}

<script src="{{=URL('static', 'js/default_index.js')}}"></script>